{{define "content"}}
<div class="container-fluid">
  <div class="card card-primary">
    <div class="card-header">
      <h3 class="card-title">System Logs</h3>
    </div>
    <div class="card-body">
      {{if eq ._role 2}}
      <button id="deleteAll" class="btn btn-warning cardbtn">Delete all</button>
      {{end}}
      <table class="table table-bordered">
        <thead>
          <tr>
            <th class="th-50">ID</th>
            <th class="th-70">Level</th>
            <th class="th-200">Name</th>
            <th>Message</th>
            <th class="th-170">Time</th>
          </tr>
        </thead>
        <tbody id="notifications">
          {{range .notifications}}
          <tr>
            <td>{{ .ID }}</td>
            {{if eq .Level 0}}
            <td><span class="badge bg-primary">INFO</span></td>
            {{end}}
            {{if eq .Level 1}}
            <td><span class="badge bg-success">SUCCESS</span></td>
            {{end}}
            {{if eq .Level 2}}
            <td><span class="badge bg-warning">WARNING</span></td>
            {{end}}
            {{if eq .Level 3}}
            <td><span class="badge bg-danger">ERROR</span></td>
            {{end}}
            {{if eq .Level 4}}
            <td><span class="badge bg-orange">FATAL</span></td>
            {{end}}
            <td>{{ .Name }}</td>
            <td>{{ .Message }}</td>
            <td>{{ time .Track.CreatedAt }}</td>
          </tr>
          {{end}}
        </tbody>
      </table>
    </div>
    <div class="card-footer clearfix">
      <ul class="pagination pagination-sm m-0 d-flex justify-content-center">
        {{range split ._page ._totpage}}
        {{if .Active}}
        <li class="page-item active"><a class="page-link" page="{{.Number}}">{{.Text}}</a></li>
        {{else}}
        {{if .Disabled}}
        <li class="page-item disabled"><a class="page-link" page="{{.Number}}">{{.Text}}</a></li>
        {{else}}
        <li class="page-item"><a class="page-link" page="{{.Number}}">{{.Text}}</a></li>
        {{end}}
        {{end}}
        {{end}}
        <li>
          <select class="form-control pagebtn">
            <option value="5">5 / page</option>
            <option value="10">10 / page</option>
            <option value="20">20 / page</option>
            <option value="50">50 / page</option>
          </select>
        </li>
      </ul>
    </div>
  </div>
</div>
{{end}}

{{define "js"}}
<script nonce="{{ ._nonce }}">
  "use strict"

  let sp = GetPageSize(10, [5, 10, 20, 50]);

  $(".pagebtn").on("change", function () {
    InsertParam("size", this.value)
  });

  $(".page-item").click((e) => {
    InsertParam("page", e.target.getAttribute("page"))
  })

  $("#deleteAll").click((e) => {
    JSONDelete("/api/notification").done(DelayReload());
  })
</script>
{{end}}