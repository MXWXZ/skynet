<!DOCTYPE html>
<html lang="en">

<head>
  {{ template "common_header" . }}
  {{block "header" .}}{{end}}
</head>

<body class="layout-navbar-fixed layout-fixed control-sidebar-slide-open sidebar-mini">
  <div class="wrapper">
    <nav class="main-header navbar navbar-expand navbar-white navbar-light">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" data-widget="pushmenu" data-enable-remember="true" href="#" role="button"><i
              class="fas fa-bars"></i></a>
        </li>
      </ul>

      <ul class="navbar-nav ml-auto">
        <li class="nav-item dropdown">
          <a class="nav-link" data-toggle="dropdown" href="#">
            <i class="far fa-bell"></i>
          </a>
          <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
            <span class="dropdown-item dropdown-header">0 Notifications</span>
            <div class="dropdown-divider"></div>
            <a href="#" class="dropdown-item dropdown-footer">See All Notifications</a>
          </div>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-widget="fullscreen" href="#" role="button">
            <i class="fas fa-expand-arrows-alt"></i>
          </a>
        </li>
      </ul>
    </nav>

    <aside class="main-sidebar sidebar-dark-primary elevation-4">
      <a href="/dashboard" class="brand-link text-center">
        <span class="brand-text font-weight-light"><b>Skynet</b></span>
      </a>

      <div class="sidebar">
        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
          <div class="image">
            <img src="data:image/webp;base64,{{ ._avatar }}" class="img-circle elevation-2" alt="User Image">
          </div>
          <div class="info username">
            <a href="#" class="d-block text-truncate">{{ ._username }}</a>
          </div>
          <div class="info ml-auto">
            <button id="signout" type="button" class="mr-auto btn btn-xs btn-outline-danger btn-flat">Sign out</button>
          </div>
        </div>

        <nav class="mt-2">
          <ul class="nav nav-pills nav-sidebar flex-column nav-compact nav-flat" data-widget="treeview" role="menu"
            data-accordion="false">
            {{ define "walknav" }}
            {{range .Item}}
            {{if ge $.Role .Role}}
            {{if .Open}}
            <li class="nav-item menu-is-opening menu-open">
              {{else}}
            <li class="nav-item">
              {{end}}
              {{if .Active}}
              <a href="{{ .Link }}" class="nav-link active">
                {{else}}
                <a href="{{ .Link }}" class="nav-link">
                  {{end}}
                  <i class="nav-icon fas {{ .Icon }}"></i>
                  <p>{{ .Name }}
                    {{if .Child}}
                    <i class="fas fa-angle-left right"></i>
                  </p>
                  {{else}}
                  </p>
                  {{end}}
                </a>
                {{if .Child}}
                <ul class="nav nav-treeview">
                  {{ template "walknav" dict "Item" .Child "Role" $.Role }}
                </ul>
                {{end}}
                {{end}}
                {{end}}
                {{end}}
                {{ template "walknav" dict "Item" ._navbar "Role" ._role }}
          </ul>
        </nav>
      </div>
    </aside>

    <div class="content-wrapper">
      <section class="content-header">
        <div class="container-fluid">
          <div class="row mb-2">
            <div class="col-sm-6">
              <h1>{{ ._name }}</h1>
            </div>
            <div class="col-sm-6">
              <ol class="breadcrumb float-sm-right">
                {{ define "walkpath" }}
                {{if .Active}}
                <li class="breadcrumb-item active">{{ .Name }}</li>
                {{else}}
                <li class="breadcrumb-item"><a href="{{ .Link }}">{{ .Name }}</a></li>
                {{end}}
                {{if .Child}}
                {{ template "walkpath" .Child }}
                {{end}}
                {{end}}
                {{ template "walkpath" ._path }}
              </ol>
            </div>
          </div>
        </div>
      </section>

      <section class="content">
        {{block "content" .}}{{end}}
      </section>
    </div>

    <footer class="main-footer">
      Version {{ ._version }} Copyright Â© 2021 <a href="https://www.imwxz.com/">imwxz</a>. All rights
      reserved.
    </footer>
  </div>

  {{block "js" .}}{{end}}
  <script nonce="{{ ._nonce }}">
    "use strict"

    $("#signout").click(function () {
      $.get({{ api "/signout" }}).fail(function (d) {
        if (d.responseText == undefined) toastr.error("Connect error");
        else toastr.error(d.responseText);
      }).done(function (d) {
        if (d.code != 0)
          toastr.error(d.msg);
        else
          toastr.success(d.msg, "", {
            timeOut: 500, onHidden: () => {
              window.location.href = "/";
            }
          });
      })
    });
  </script>
</body>

{{ template "common_footer" . }}
{{block "footer" .}}{{end}}

</html>